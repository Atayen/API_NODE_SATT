image: atayen/atayen:1.0
clone:
    depth: full
pipelines:
    branches:
        DevOps: 
            - step: 
                name:  check Directory 
                script: 
                  - /bin/ls /opt/atlassian/pipelines/agent/build/
            - step:
                name: put file on production 
                script: 
                  - sed -i '72,77 s/^/#/' .env
                  -  sed -i -e '$a'${L1} .env
                  -  sed -i -e '$a'${L2} .env
                  -  sed -i -e '$a'${L3} .env
                  -  sed -i -e '$a'${L4} .env
                  -  sed -i -e '$a'${L5} .env
                  -  sed -i -e '$a'${L6} .env
                  -  ssh-keyscan -H 92.243.9.233 >> ~/.ssh/known_hosts
                  -  sshpass -p ${SCP_PASSWORD} ssh gdah@92.243.9.233 "cd /home/oracles/DevOps/build/ && pm2 stop 0"
                  -  sshpass -p ${SCP_PASSWORD} ssh gdah@92.243.9.233 "rm -rf /home/oracles/DevOps/build/"
                  -  sshpass -p ${SCP_PASSWORD} scp -v -pr ../build/ gdah@92.243.9.233:/home/oracles/DevOps/ 
                  -  sshpass -p ${SCP_PASSWORD} ssh gdah@92.243.9.233 "cd /home/oracles/DevOps/build/ && npm install"
                  -  sshpass -p ${SCP_PASSWORD} ssh gdah@92.243.9.233 "cd /home/oracles/DevOps/build/ && pm2 start 0"